I will migrate the `bias-detection` codebase to the Code Mode architecture (Core / Code Mode / MCP) following the established patterns.

### 1. Analysis & Preparation
- **Current State**: Single file `src/index.ts` containing logic (`detectBias`), MCP Server (`BiasDetectionServer`), and entry point. Tests are in `src/index.test.ts`.
- **Target Architecture**:
  - `src/core/`: Pure logic (types, business logic).
  - `src/codemode/`: Public programmable API.
  - `src/mcp/`: Protocol adapter.
  - `tests/`: Split tests by layer.

### 2. Implementation Steps

#### Phase 1: Directory Structure
- Create directories: `src/core`, `src/codemode`, `src/mcp`, `tests/core`, `tests/codemode`, `tests/mcp`.

#### Phase 2: Core Layer (`src/core/`)
- **`types.ts`**: Extract `BiasDetectionInput` and define `BiasDetectionResult` (cleaner type than the MCP `Result`).
- **`logic.ts`**: Move `detectBias` function and `BIAS_WORDS` constant here. Make it a pure function.

#### Phase 3: Code Mode Layer (`src/codemode/`)
- **`index.ts`**: Create `BiasDetectionClient` class.
  - Wraps the Core logic.
  - Exposes a clean API: `detectBias(input: BiasDetectionInput): Promise<BiasDetectionResult>`.

#### Phase 4: MCP Adapter Layer (`src/mcp/`)
- **`tools.ts`**: Define the JSON Schema for the `biasDetection` tool.
- **`server.ts`**: Implement the MCP server that uses `BiasDetectionClient`.
  - Maps MCP `CallToolRequest` to `client.detectBias()`.
  - Formats the result into the MCP `CallToolResult` structure.

#### Phase 5: Entry Point & Cleanup
- **`src/index.ts`**:
  - Export `BiasDetectionClient` for Code Mode usage.
  - Conditionally run the MCP server if executed directly (`import.meta.main`).
- **`package.json`**: Ensure exports point to the new structure.

#### Phase 6: Testing
- **`tests/core/logic.test.ts`**: Test `detectBias` logic (algorithm tests).
- **`tests/codemode/client.test.ts`**: Test the `BiasDetectionClient` API.
- **`tests/mcp/server.test.ts`**: Test the MCP server request handling and tool definitions.

### 3. Verification
- Run `bun test` to ensure all tests pass.
- Verify the build output with `bun run build`.
